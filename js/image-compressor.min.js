/*!
 * Compressor.js v1.1.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-10-05T02:32:40.212Z
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Compressor=t()}(this,function(){"use strict";function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e){return(t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function r(e){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,r=t(e);if(a){var n=t(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return i.apply(this,arguments)}}function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function s(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function h(e,t){var a=function(e,t){var a=s({x:e.x-t.x,y:e.y-t.y});return{x:(e.x+t.x)/2,y:(e.y+t.y)/2,z:s({x:(e.x+t.x)/2,y:(e.y+t.y)/2}),r:a/2}}(e,t),i=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}(e,t)/2,r={x:t.x-e.x,y:t.y-e.y},n=[];return r.x>=0&&r.y>=0?n.push({x:e.x-i,y:e.y-i},{x:t.x+i,y:t.y+i}):r.x>=0&&r.y<0?n.push({x:e.x-i,y:e.y+i},{x:t.x+i,y:t.y-i}):r.x<0&&r.y>=0?n.push({x:e.x+i,y:e.y-i},{x:t.x-i,y:t.y+i}):r.x<0&&r.y<0&&n.push({x:e.x+i,y:e.y+i},{x:t.x-i,y:t.y-i}),{c:a,p:n}}function l(e,t){var a=e.width/e.height,i=t.width/t.height;return a>i?{width:t.width,height:t.width/a}:{width:t.height*a,height:t.height}}function c(e){var t=e.replace(/^data:image\/([\w+]+);base64,/,"");return"image/jpeg"===e.slice(0,10)?{ext:"jpg",data:t}:"image/png"===e.slice(0,9)?{ext:"png",data:t}:null}function u(e){var t=e.naturalWidth||e.width,a=e.naturalHeight||e.height;return"svg"===e.type.split("/")[1]||t&&a}var d=window.URL||window.webkitURL,g=/^(?:Blob|File)$/;var f=window.navigator&&/Macintosh/.test(window.navigator.userAgent),p=window.navigator&&window.navigator.msSaveOrOpenBlob;function m(e,t){var a;try{a=new DataTransfer;for(var i=0,r=t;i<r.length;i++){var o=r[i];a.items.add(o)}e.files=a.files}catch(t){if(e.multiple){var s=n(e.files);e.value="";for(var h=0,l=s;h<l.length;h++){var c=l[h];e.files.add(c)}}else e.value=t}}var v=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=Object.assign({},t.defaults,e),this.aborted=!1,this.result=null,this.init()}var o,s,v;return o=t,s=[{key:"init",value:function(){var e,t=this,a=this.options,i=a.file;if(i){var r=i.type;if(function(e){return/^image\/\w+$/.test(e)}(r)){if(a.checkOrientation&&function(e){return/^image\/jpe?g$/.test(e)}(r)){e=function(e){var t=new DataView(e),a=void 0,i=void 0,r=void 0,n=void 0,o=void 0;if(255===t.getUint8(0)&&216===t.getUint8(1))for(var s=t.byteLength,h=2;h+1<s;){if(255===t.getUint8(h)&&225===t.getUint8(h+1)){r=h;break}h+=1}if(r){var l=r+10;if("Exif"===function(e,t,a){var i="";a+=t;for(var r=t;r<a;r+=1)i+=String.fromCharCode(e.getUint8(r));return i}(t,r+4,4)){var c=t.getUint16(l);if(((i=18761===c)||19789===c)&&42===t.getUint16(l+2,i)){var u=t.getUint32(l+4,i);u>=8&&(n=l+u)}}if(n){var d=t.getUint16(n,i);for(o=0;o<d;o+=1)if(a=n+12*o+2,274===t.getUint16(a,i)){a+=8,e=t.getUint16(a,i),t.setUint16(a,1,i);break}}}return e}(new Uint8Array(function(e){var t=e.split(",")[0].match(/:(.*?);/)[1],a=atob(e.split(",")[1]),i=a.length,r=new Uint8Array(i);for(;i--;)r[i]=a.charCodeAt(i);return r.buffer}(function(e){var t=new FileReader;return t.readAsDataURL(e),new Promise(function(e,a){t.onload=function(t){e(t.target.result)},t.onerror=function(e){a(e)}})}(i))));var n=e>1||!e}else n=!1;this.options.rotatable=n;var o=i.size/1024/1024,s=document.createElement("canvas"),h=s.getContext("2d"),l=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}(i);if(i.name&&"string"==typeof i.name&&(this.filename=i.name,this.filename=this.filename.replace(/\.\w+$/,""),this.filename+=".".concat("image/jpeg"===a.mimeType?"jpg":"png")),"image"!==l&&g.test(l)){var c=function(e){return new Promise(function(t,a){var i=new Image;i.onload=function(){t(i)},i.onerror=function(e){a(e)},i.src=d.createObjectURL(e)})}(i);c.then(function(i){if(!t.aborted){var r=i.naturalWidth,n=i.naturalHeight;if(a.success&&a.success.call(t,{width:r,height:n}),o>a.maxSize&&(!a.maxWidth||!a.maxHeight))t.done({width:r,height:n});else{var l=document.createElement("canvas"),c=l.getContext("2d");l.width=r,l.height=n,c.save(),c.drawImage(i,0,0,r,n),c.restore();var g=l.toDataURL(a.mimeType,a.quality),f=function(e){return new Promise(function(t,a){var i=new Image;i.onload=function(){t(i)},i.onerror=function(e){a(e)},i.src=e})}(g);f.then(function(i){if(!t.aborted){var n=i.naturalWidth,l=i.naturalHeight;if(e&&function(e){var t=e;if(t>8)return t-=8;if(t>0)return t-=1;return t}(e)>0){var c=document.createElement("canvas"),g=c.getContext("2d"),f=n,p=l,m=0,v=0;switch(e){case 2:f=-n,g.scale(-1,1);break;case 3:f=-n,p=-l,g.scale(-1,-1);break;case 4:p=-l,g.scale(1,-1);break;case 5:c.width=l,c.height=n,g.rotate(.5*Math.PI),g.scale(1,-1),v=-l,g.drawImage(i,0,0,n,l,v,m,l,n);break;case 6:c.width=l,c.height=n,g.rotate(.5*Math.PI),m=-l,g.drawImage(i,0,0,n,l,v,m,l,n);break;case 7:c.width=l,c.height=n,g.rotate(.5*Math.PI),f=-n,m=-l,g.scale(-1,1),g.drawImage(i,0,0,n,l,v,m,l,n);break;case 8:c.width=l,c.height=n,g.rotate(-.5*Math.PI),v=-n,g.drawImage(i,0,0,n,l,v,m,l,n);break;default:c.width=n,c.height=l,g.drawImage(i,0,0,n,l)}5>e&&(c.width=f,c.height=p,g.drawImage(i,0,0,n,l,m,v,f,p))}else{c=document.createElement("canvas");var w=c.getContext("2d"),y=function(e,t){var a=e.aspectRatio,i=e.width,r=e.height,n=e.maxWidth,o=e.maxHeight,s=e.minWidth,h=e.minHeight,l=i/r;if(n&&o){if(a&&l>a){if(i>n)r=(i=n)/l;else if(r>o)i=(r=o)*l}else if(i>n)r=(i=n)/l;else if(r>o)i=(r=o)*l}else if(n)i>n&&(r=(i=n)/l);else if(o)r>o&&(i=(r=o)*l);if(s||h){if(a&&l>a){if(i<s)r=(i=s)/l;else if(r<h)i=(r=h)*l}else if(i<s)r=(i=s)/l;else if(r<h)i=(r=h)*l}return{width:i,height:r}}({aspectRatio:a.aspectRatio,width:n,height:l,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:a.minHeight});c.width=y.width,c.height=y.height,a.beforeDraw&&a.beforeDraw.call(t,c,w),a.drew&&a.drew.call(t,c,w),w.save(),w.fillStyle=a.fillColor,w.fillRect(0,0,c.width,c.height),w.restore(),w.save(),a.rotatable&&w.translate(c.width/2,c.height/2),w.drawImage(i,Math.floor((c.width-n)/2),Math.floor((c.height-l)/2),n,l),w.restore(),a.drew&&a.drew.call(t,c,w)}var b=c.width,x=c.height,C=function(){if(!t.aborted){var e=c.toDataURL(a.mimeType,a.quality);if(a.convertTypes.length>0&&a.mimeType!==i.type&&a.convertTypes.indexOf(i.type)>=0){var r=c.toDataURL(i.type);if(r.length<e.length)e=r}if(a.width||a.height){var n=document.createElement("canvas"),o=n.getContext("2d"),s=a.width||b,h=a.height||x,l=b,g=x;b>s&&(g=g*s/b,l=s),g>h&&(l=l*h/g,g=h),n.width=l,n.height=g,o.save(),o.drawImage(c,0,0,b,x,0,0,l,g),o.restore();var d=n.toDataURL(a.mimeType,a.quality);if(a.convertTypes.length>0&&a.mimeType!==i.type&&a.convertTypes.indexOf(i.type)>=0){var f=n.toDataURL(i.type);f.length<d.length&&(d=f)}d.length<e.length&&(e=d)}var p=function(e){var t=c(e);if(!t)return null;try{return function(e,t){for(var a=atob(e),i=a.length,r=new Uint8Array(i),n=0;n<i;n+=1)r[n]=a.charCodeAt(n);return new Blob([r],{type:t})}(t.data,a.mimeType)}catch(e){return null}}(e);t.result=p||function(e){var t=e.split(",")[0].match(/:(.*?);/)[1],a=atob(e.split(",")[1]),i=a.length,r=new Uint8Array(i);for(;i--;)r[i]=a.charCodeAt(i);return new Blob([r],{type:t})}(e),t.done({width:b,height:x})}};a.checkOrientation&&n?setTimeout(C,0):C()}})}}),d.revokeObjectURL(c.src)}else{var f=new Image;f.onload=function(){if(!t.aborted){var i=f.naturalWidth,r=f.naturalHeight;if(a.success&&a.success.call(t,{width:i,height:r}),o>a.maxSize&&(!a.maxWidth||!a.maxHeight))t.done({width:i,height:r});else{var n=l({width:i,height:r},{width:a.maxWidth||1/0,height:a.maxHeight||1/0}),c=n.width,g=n.height,p=document.createElement("canvas"),m=p.getContext("2d");p.width=c,p.height=g,a.beforeDraw&&a.beforeDraw.call(t,p,m),a.drew&&a.drew.call(t,p,m),m.save(),m.fillStyle=a.fillColor,m.fillRect(0,0,c,g),m.restore(),m.save(),a.rotatable&&m.translate(c/2,g/2),m.drawImage(f,0,0,c,g),m.restore(),a.drew&&a.drew.call(t,p,m);var v=p.toDataURL(a.mimeType,a.quality);if(a.convertTypes.length>0&&a.mimeType!==e.type&&a.convertTypes.indexOf(e.type)>=0){var w=p.toDataURL(e.type);w.length<v.length&&(v=w)}if(a.width||a.height){var y=document.createElement("canvas"),b=y.getContext("2d"),x=a.width||c,C=a.height||g,M=c,I=g;c>x&&(I=I*x/c,M=x),I>C&&(M=M*C/I,I=C),y.width=M,y.height=I,b.save(),b.drawImage(p,0,0,c,g,0,0,M,I),b.restore();var O=y.toDataURL(a.mimeType,a.quality);if(a.convertTypes.length>0&&a.mimeType!==e.type&&a.convertTypes.indexOf(e.type)>=0){var k=y.toDataURL(e.type);k.length<O.length&&(O=k)}O.length<v.length&&(v=O)}var T=function(e){var t=c(e);if(!t)return null;try{return function(e,t){for(var a=atob(e),i=a.length,r=new Uint8Array(i),n=0;n<i;n+=1)r[n]=a.charCodeAt(n);return new Blob([r],{type:t})}(t.data,a.mimeType)}catch(e){return null}}(v);t.result=T||function(e){var t=e.split(",")[0].match(/:(.*?);/)[1],a=atob(e.split(",")[1]),i=a.length,r=new Uint8Array(i);for(;i--;)r[i]=a.charCodeAt(i);return new Blob([r],{type:t})}(v),t.done({width:M||c,height:I||g})}}},f.onabort=function(){t.aborted||t.fail(new Error("Aborted to load the image."))},f.onerror=function(){t.aborted||t.fail(new Error("Failed to load the image."))};var p=i.url||i;if(f.src=p,f.complete&&u(f))f.onload=null,f.onerror=null,f.onabort=null}}}else this.fail(new Error("The first argument must be an image File or Blob object."));else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"done",value:function(e){var t=this.options,a=this.file,i=this.filename,r=this.result;if(t.done){var n=t.done.call(this,{naturalWidth:e.width,naturalHeight:e.height,result:r,file:a,name:i});void 0!==n&&(this.result=n)}}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.result&&(this.result=null))}}],v=[{key:"noConflict",value:function(){return window.Compressor=null,t}},{key:"setDefaults",value:function(e){Object.assign(t.defaults,e)}}],s&&e(o.prototype,s),v&&e(o,v),Object.defineProperty(o,"prototype",{writable:!1}),t}();return v.defaults={aspectRatio:NaN,beforeDraw:null,checkOrientation:!0,convertTypes:[],drew:null,error:null,fillColor:"transparent",height:void 0,maxHeight:1/0,maxSize:1/0,maxWidth:1/0,mimeType:"auto",minHeight:0,minWidth:0,quality:.8,rotatable:!0,success:null,width:void 0,convertSize:5242880},v});
